<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="CoulombLogFunctions_8cpp" kind="file" language="C++">
    <compoundname>CoulombLogFunctions.cpp</compoundname>
    <includes refid="NumericFunctions_8hpp" local="yes">../include/ibs_bits/NumericFunctions.hpp</includes>
    <includes refid="RadiationDamping_8hpp" local="yes">../include/ibs_bits/RadiationDamping.hpp</includes>
    <includes local="no">math.h</includes>
    <includes local="no">stdio.h</includes>
    <incdepgraph>
      <node id="5">
        <label>string</label>
      </node>
      <node id="2">
        <label>../include/ibs_bits/NumericFunctions.hpp</label>
        <link refid="NumericFunctions_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>map</label>
      </node>
      <node id="7">
        <label>../include/ibs_bits/RadiationDamping.hpp</label>
        <link refid="RadiationDamping_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>vector</label>
      </node>
      <node id="1">
        <label>/home/mti/github-tomerten/ibs/cpp/src/CoulombLogFunctions.cpp</label>
        <link refid="CoulombLogFunctions_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>math.h</label>
      </node>
      <node id="8">
        <label>iostream</label>
      </node>
      <node id="4">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="func">
      <memberdef kind="function" id="CoulombLogFunctions_8cpp_1abf7b9e9c5da8bf0b23fffcb01961ebbe" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void twclog</definition>
        <argsstring>(double pnumber, double bx, double by, double dx, double dy, double ex, double ey, double r0, double gamma, double charge, double en0, double amass, double sige, double sigt, double *clog)</argsstring>
        <name>twclog</name>
        <param>
          <type>double</type>
          <declname>pnumber</declname>
        </param>
        <param>
          <type>double</type>
          <declname>bx</declname>
        </param>
        <param>
          <type>double</type>
          <declname>by</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dx</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dy</declname>
        </param>
        <param>
          <type>double</type>
          <declname>ex</declname>
        </param>
        <param>
          <type>double</type>
          <declname>ey</declname>
        </param>
        <param>
          <type>double</type>
          <declname>r0</declname>
        </param>
        <param>
          <type>double</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>double</type>
          <declname>charge</declname>
        </param>
        <param>
          <type>double</type>
          <declname>en0</declname>
        </param>
        <param>
          <type>double</type>
          <declname>amass</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sige</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sigt</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>clog</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/mti/github-tomerten/ibs/cpp/src/CoulombLogFunctions.cpp" line="67" column="6" bodyfile="/home/mti/github-tomerten/ibs/cpp/src/CoulombLogFunctions.cpp" bodystart="67" bodyend="120"/>
      </memberdef>
      <memberdef kind="function" id="CoulombLogFunctions_8cpp_1aaeb3e23eea67e16a5329a24687458297" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void twclogtail</definition>
        <argsstring>(double pnumber, double l, double bx, double by, double dx, double dpx, double dy, double dpy, double ax, double ay, double angle, double k1l, double k1sl, double ex, double ey, double r0, double aatom, double gamma, double en0, double len, double amass, double charge, double sige, double sigt, double *clog)</argsstring>
        <name>twclogtail</name>
        <param>
          <type>double</type>
          <declname>pnumber</declname>
        </param>
        <param>
          <type>double</type>
          <declname>l</declname>
        </param>
        <param>
          <type>double</type>
          <declname>bx</declname>
        </param>
        <param>
          <type>double</type>
          <declname>by</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dx</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dpx</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dy</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dpy</declname>
        </param>
        <param>
          <type>double</type>
          <declname>ax</declname>
        </param>
        <param>
          <type>double</type>
          <declname>ay</declname>
        </param>
        <param>
          <type>double</type>
          <declname>angle</declname>
        </param>
        <param>
          <type>double</type>
          <declname>k1l</declname>
        </param>
        <param>
          <type>double</type>
          <declname>k1sl</declname>
        </param>
        <param>
          <type>double</type>
          <declname>ex</declname>
        </param>
        <param>
          <type>double</type>
          <declname>ey</declname>
        </param>
        <param>
          <type>double</type>
          <declname>r0</declname>
        </param>
        <param>
          <type>double</type>
          <declname>aatom</declname>
        </param>
        <param>
          <type>double</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>double</type>
          <declname>en0</declname>
        </param>
        <param>
          <type>double</type>
          <declname>len</declname>
        </param>
        <param>
          <type>double</type>
          <declname>amass</declname>
        </param>
        <param>
          <type>double</type>
          <declname>charge</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sige</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sigt</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>clog</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/mti/github-tomerten/ibs/cpp/src/CoulombLogFunctions.cpp" line="200" column="6" bodyfile="/home/mti/github-tomerten/ibs/cpp/src/CoulombLogFunctions.cpp" bodystart="200" bodyend="285"/>
      </memberdef>
      <memberdef kind="function" id="CoulombLogFunctions_8cpp_1ab908400a7d0b3f9d9d35da9684d875c2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void CoulombLog</definition>
        <argsstring>(double pnumber, double ex, double ey, map&lt; string, double &gt; &amp;twissheader, double sige, double sigt, double r0, bool printout, double *clog)</argsstring>
        <name>CoulombLog</name>
        <param>
          <type>double</type>
          <declname>pnumber</declname>
        </param>
        <param>
          <type>double</type>
          <declname>ex</declname>
        </param>
        <param>
          <type>double</type>
          <declname>ey</declname>
        </param>
        <param>
          <type>map&lt; string, double &gt; &amp;</type>
          <declname>twissheader</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sige</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sigt</declname>
        </param>
        <param>
          <type>double</type>
          <declname>r0</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>printout</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>clog</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/mti/github-tomerten/ibs/cpp/src/CoulombLogFunctions.cpp" line="334" column="6" bodyfile="/home/mti/github-tomerten/ibs/cpp/src/CoulombLogFunctions.cpp" bodystart="334" bodyend="419"/>
      </memberdef>
      <memberdef kind="function" id="CoulombLogFunctions_8cpp_1ada19d63bb5e67dfd7885b4bd24c5bcb1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void TailCutCoulombLog</definition>
        <argsstring>(double pnumber, double ex, double ey, map&lt; string, double &gt; &amp;twissheader, double sige, double sigt, double tauradx, double taurady, double taurads, double r0, bool printout, double *clog)</argsstring>
        <name>TailCutCoulombLog</name>
        <param>
          <type>double</type>
          <declname>pnumber</declname>
        </param>
        <param>
          <type>double</type>
          <declname>ex</declname>
        </param>
        <param>
          <type>double</type>
          <declname>ey</declname>
        </param>
        <param>
          <type>map&lt; string, double &gt; &amp;</type>
          <declname>twissheader</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sige</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sigt</declname>
        </param>
        <param>
          <type>double</type>
          <declname>tauradx</declname>
        </param>
        <param>
          <type>double</type>
          <declname>taurady</declname>
        </param>
        <param>
          <type>double</type>
          <declname>taurads</declname>
        </param>
        <param>
          <type>double</type>
          <declname>r0</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>printout</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>clog</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/mti/github-tomerten/ibs/cpp/src/CoulombLogFunctions.cpp" line="475" column="6" bodyfile="/home/mti/github-tomerten/ibs/cpp/src/CoulombLogFunctions.cpp" bodystart="475" bodyend="574"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;../include/ibs_bits/NumericFunctions.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../include/ibs_bits/RadiationDamping.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="7"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="8"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="9"><highlight class="comment">METHOD<sp/>TO<sp/>CALCULATE<sp/>COULOMBLOG<sp/>PER<sp/>ELEMENT<sp/>OR<sp/>USING<sp/>ELEMENT<sp/>BY<sp/>ELEMENT</highlight></codeline>
<codeline lineno="10"><highlight class="comment">TWISS<sp/>DATA.</highlight></codeline>
<codeline lineno="11"><highlight class="comment"></highlight></codeline>
<codeline lineno="12"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/><sp/>AUTHORS:</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>MADX<sp/>COPYRIGHT<sp/>CERN</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>TOM<sp/>MERTENS</highlight></codeline>
<codeline lineno="16"><highlight class="comment"></highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/><sp/>HISTORY:</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>08/06/2021<sp/>:<sp/>initial<sp/>cpp<sp/>version<sp/>(Tom)</highlight></codeline>
<codeline lineno="19"><highlight class="comment"></highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/><sp/>REF:</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculation<sp/>of<sp/>Coulomb<sp/>logarithm<sp/>(and<sp/>print)</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>based<sp/>on<sp/>the<sp/>formulae<sp/>in<sp/>AIP<sp/>physics<sp/>vade<sp/>mecum<sp/>p.264<sp/>(1981)</highlight></codeline>
<codeline lineno="23"><highlight class="comment"></highlight></codeline>
<codeline lineno="24"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/><sp/>Arguments:</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/><sp/>----------</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>pnumber</highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>number<sp/>of<sp/>particles</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>bx</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>beta<sp/>x</highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>by</highlight></codeline>
<codeline lineno="32"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>beta<sp/>y</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>dx</highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispersion<sp/>x</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>dy</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispersion<sp/>y</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>ex</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>emittance<sp/>x</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>ey</highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>emittance<sp/>y</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>r0</highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>classical<sp/>particle<sp/>radius</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>gamma</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>relativistic<sp/>gamma</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>charge</highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>particle<sp/>charge</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>en0</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>particle<sp/>energy</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>amass</highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>particle<sp/>mass</highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>sige</highlight></codeline>
<codeline lineno="52"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>energy<sp/>spread</highlight></codeline>
<codeline lineno="53"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>sigt</highlight></codeline>
<codeline lineno="54"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bunch<sp/>length<sp/>(s)</highlight></codeline>
<codeline lineno="55"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double*<sp/>clog</highlight></codeline>
<codeline lineno="56"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output<sp/>variable</highlight></codeline>
<codeline lineno="57"><highlight class="comment"></highlight></codeline>
<codeline lineno="58"><highlight class="comment"><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="59"><highlight class="comment"><sp/><sp/>--------</highlight></codeline>
<codeline lineno="60"><highlight class="comment"><sp/><sp/>double[2]<sp/>clog</highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/><sp/><sp/><sp/>1<sp/>-&gt;<sp/>coulomblog</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/><sp/><sp/><sp/>2<sp/>-&gt;<sp/>coulomblog<sp/>constant</highlight></codeline>
<codeline lineno="63"><highlight class="comment"></highlight></codeline>
<codeline lineno="64"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="65"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="66"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="CoulombLogFunctions_8cpp_1abf7b9e9c5da8bf0b23fffcb01961ebbe" kindref="member">twclog</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>pnumber,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bx,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>by,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dx,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dy,</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ex,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ey,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r0,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>gamma,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>charge,</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>en0,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>amass,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sige,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigt,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*clog)<sp/>{</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>constants</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ot2<sp/>=<sp/>1.0e2;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ft8<sp/>=<sp/>5.0e8;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ot5<sp/>=<sp/>1.0e5;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ttm3<sp/>=<sp/>2.0e-3;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>fac1<sp/>=<sp/>743.4;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>fac2<sp/>=<sp/>1.44e-7;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>c<sp/>=<sp/><ref refid="NumericFunctions_8hpp_1aa31d45974a65b3b50eb72c5fa8663dc2" kindref="member">clight</ref>;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>IMPORTANT:<sp/>HBAR<sp/>USED<sp/>HERE<sp/>IS<sp/>REDUCED<sp/>PLANCK<sp/>CONSTANT<sp/>IN<sp/>GEV!!!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>const<sp/>double<sp/>hbar<sp/>=<sp/>6.582119569e-25;<sp/>//<sp/>1.0545718176461565e-34;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>two<sp/>=<sp/>2.0;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eight<sp/>=<sp/>8.0f;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>betar<sp/>=<sp/>sqrt(1.0<sp/>-<sp/>1.0<sp/>/<sp/>(gamma<sp/>*<sp/>gamma));</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>qion<sp/>=<sp/>fabs(charge);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>etrans<sp/>=<sp/>ft8<sp/>*<sp/>(gamma<sp/>*<sp/>en0<sp/>-<sp/>amass)<sp/>*<sp/>(ex<sp/>/<sp/>bx);</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tempev<sp/>=<sp/>two<sp/>*<sp/>etrans;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>beam<sp/>volume<sp/>to<sp/>get<sp/>density<sp/>(in<sp/>cm**-3).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigxcm<sp/>=<sp/>ot2<sp/>*<sp/>sqrt(ex<sp/>*<sp/>bx<sp/>+<sp/>(dx<sp/>*<sp/>dx<sp/>*<sp/>sige<sp/>*<sp/>sige));</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigycm<sp/>=<sp/>ot2<sp/>*<sp/>sqrt(ey<sp/>*<sp/>by<sp/>+<sp/>(dy<sp/>*<sp/>dy<sp/>*<sp/>sige<sp/>*<sp/>sige));</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigtcm<sp/>=<sp/>ot2<sp/>*<sp/>sigt;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>vol<sp/>=<sp/>eight<sp/>*<sp/>sqrt(<ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref>)<sp/>*<sp/>sigxcm<sp/>*<sp/>sigycm<sp/>*<sp/>sigtcm;</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>densty<sp/>=<sp/>pnumber<sp/>/<sp/>vol;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>RMAX<sp/>as<sp/>smaller<sp/>of<sp/>SIGXCM<sp/>and<sp/>DEBYE<sp/>length.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>debyel<sp/>=<sp/>fac1<sp/>*<sp/>sqrt(tempev<sp/>/<sp/>densty)<sp/>/<sp/>qion;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmax<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1ac6afabdc09a49a433ee19d8a9486056d" kindref="member">min</ref>(sigxcm,<sp/>debyel);</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>RMIN<sp/>as<sp/>larger<sp/>of<sp/>classical<sp/>distance<sp/>of<sp/>closest<sp/>approach</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>or<sp/>quantum<sp/>mechanical<sp/>diffraction<sp/>limit<sp/>from<sp/>nuclear<sp/>radius.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmincl<sp/>=<sp/>fac2<sp/>*<sp/>qion<sp/>*<sp/>qion<sp/>/<sp/>tempev;</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rminqm<sp/>=<sp/><ref refid="NumericFunctions_8hpp_1a0ae50bc0ad13e33e23eec85ec44b3e2b" kindref="member">hbar</ref><sp/>*<sp/>c<sp/>*<sp/>ot5<sp/>/<sp/>(two<sp/>*<sp/>sqrt(ttm3<sp/>*<sp/>etrans<sp/>*<sp/>amass));</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmin<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(rmincl,<sp/>rminqm);</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>coulog<sp/>=<sp/>log(rmax<sp/>/<sp/>rmin);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>coulomb<sp/>log<sp/>constant<sp/>pre-factor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>constt<sp/>=<sp/>pnumber<sp/>*<sp/>coulog<sp/>*<sp/>r0<sp/>*<sp/>r0<sp/>*<sp/>c<sp/>/</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(eight<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/>betar<sp/>*<sp/>betar<sp/>*<sp/>betar<sp/>*<sp/>gamma<sp/>*<sp/>gamma<sp/>*<sp/>gamma<sp/>*</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gamma<sp/>*<sp/>ex<sp/>*<sp/>ey<sp/>*<sp/>sige<sp/>*<sp/>sigt);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/>clog[0]<sp/>=<sp/>coulog;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/>clog[1]<sp/>=<sp/>constt;</highlight></codeline>
<codeline lineno="120"><highlight class="normal">}</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="122"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="123"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="124"><highlight class="comment">METHOD<sp/>TO<sp/>CALCULATE<sp/>COULOMBLOG<sp/>PER<sp/>ELEMENT<sp/>OR<sp/>USING<sp/>ELEMENT<sp/>BY<sp/>ELEMENT<sp/>TWISS</highlight></codeline>
<codeline lineno="125"><highlight class="comment">DATA<sp/>WITH<sp/>TAILCUT.</highlight></codeline>
<codeline lineno="126"><highlight class="comment"></highlight></codeline>
<codeline lineno="127"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="128"><highlight class="comment"><sp/><sp/>AUTHORS:</highlight></codeline>
<codeline lineno="129"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>MADX<sp/>COPYRIGHT<sp/>CERN</highlight></codeline>
<codeline lineno="130"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>TOM<sp/>MERTENS</highlight></codeline>
<codeline lineno="131"><highlight class="comment"></highlight></codeline>
<codeline lineno="132"><highlight class="comment"><sp/><sp/>HISTORY:</highlight></codeline>
<codeline lineno="133"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>08/06/2021<sp/>:<sp/>initial<sp/>cpp<sp/>version<sp/>(Tom)</highlight></codeline>
<codeline lineno="134"><highlight class="comment"></highlight></codeline>
<codeline lineno="135"><highlight class="comment"><sp/><sp/>REF:</highlight></codeline>
<codeline lineno="136"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculation<sp/>of<sp/>Coulomb<sp/>logarithm<sp/>(and<sp/>print)</highlight></codeline>
<codeline lineno="137"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>based<sp/>on<sp/>the<sp/>formulae<sp/>in<sp/>AIP<sp/>physics<sp/>vade<sp/>mecum<sp/>p.264<sp/>(1981)</highlight></codeline>
<codeline lineno="138"><highlight class="comment"></highlight></codeline>
<codeline lineno="139"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="140"><highlight class="comment"><sp/><sp/>Arguments:</highlight></codeline>
<codeline lineno="141"><highlight class="comment"><sp/><sp/>----------</highlight></codeline>
<codeline lineno="142"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>pnumber</highlight></codeline>
<codeline lineno="143"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>number<sp/>of<sp/>particles</highlight></codeline>
<codeline lineno="144"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>bx</highlight></codeline>
<codeline lineno="145"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>beta<sp/>x</highlight></codeline>
<codeline lineno="146"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>by</highlight></codeline>
<codeline lineno="147"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>beta<sp/>y</highlight></codeline>
<codeline lineno="148"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>dx</highlight></codeline>
<codeline lineno="149"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispersion<sp/>x</highlight></codeline>
<codeline lineno="150"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>dpx</highlight></codeline>
<codeline lineno="151"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispersion<sp/>derivative<sp/>x</highlight></codeline>
<codeline lineno="152"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>dy</highlight></codeline>
<codeline lineno="153"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispersion<sp/>y</highlight></codeline>
<codeline lineno="154"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>dpy</highlight></codeline>
<codeline lineno="155"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispersion<sp/>derivative<sp/>y</highlight></codeline>
<codeline lineno="156"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>ax</highlight></codeline>
<codeline lineno="157"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alfa<sp/>x</highlight></codeline>
<codeline lineno="158"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>ay</highlight></codeline>
<codeline lineno="159"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alfa<sp/>y</highlight></codeline>
<codeline lineno="160"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>angle</highlight></codeline>
<codeline lineno="161"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bending<sp/>angle</highlight></codeline>
<codeline lineno="162"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>k1l</highlight></codeline>
<codeline lineno="163"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>k1l<sp/>from<sp/>twiss<sp/>madx</highlight></codeline>
<codeline lineno="164"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>k1sl</highlight></codeline>
<codeline lineno="165"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>k1sl<sp/>from<sp/>twiss<sp/>madx</highlight></codeline>
<codeline lineno="166"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>ex</highlight></codeline>
<codeline lineno="167"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>emittance<sp/>x</highlight></codeline>
<codeline lineno="168"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>ey</highlight></codeline>
<codeline lineno="169"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>emittance<sp/>y</highlight></codeline>
<codeline lineno="170"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>r0</highlight></codeline>
<codeline lineno="171"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>classical<sp/>particle<sp/>radius</highlight></codeline>
<codeline lineno="172"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>aatom</highlight></codeline>
<codeline lineno="173"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>atomic<sp/>number<sp/>A</highlight></codeline>
<codeline lineno="174"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>gamma</highlight></codeline>
<codeline lineno="175"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>relativistic<sp/>gamma</highlight></codeline>
<codeline lineno="176"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>charge</highlight></codeline>
<codeline lineno="177"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>particle<sp/>charge</highlight></codeline>
<codeline lineno="178"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>en0</highlight></codeline>
<codeline lineno="179"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>particle<sp/>energy</highlight></codeline>
<codeline lineno="180"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>len</highlight></codeline>
<codeline lineno="181"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>acceleratro<sp/>length</highlight></codeline>
<codeline lineno="182"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>amass</highlight></codeline>
<codeline lineno="183"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>particle<sp/>mass</highlight></codeline>
<codeline lineno="184"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>sige</highlight></codeline>
<codeline lineno="185"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>energy<sp/>spread</highlight></codeline>
<codeline lineno="186"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>sigt</highlight></codeline>
<codeline lineno="187"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bunch<sp/>length<sp/>(s)</highlight></codeline>
<codeline lineno="188"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double*<sp/>clog</highlight></codeline>
<codeline lineno="189"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output<sp/>variable</highlight></codeline>
<codeline lineno="190"><highlight class="comment"></highlight></codeline>
<codeline lineno="191"><highlight class="comment"><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="192"><highlight class="comment"><sp/><sp/>--------</highlight></codeline>
<codeline lineno="193"><highlight class="comment"><sp/><sp/>double[2]<sp/>clog</highlight></codeline>
<codeline lineno="194"><highlight class="comment"><sp/><sp/><sp/><sp/>1<sp/>-&gt;<sp/>coulomblog</highlight></codeline>
<codeline lineno="195"><highlight class="comment"><sp/><sp/><sp/><sp/>2<sp/>-&gt;<sp/>coulomblog<sp/>constant</highlight></codeline>
<codeline lineno="196"><highlight class="comment"></highlight></codeline>
<codeline lineno="197"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="198"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="199"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="CoulombLogFunctions_8cpp_1aaeb3e23eea67e16a5329a24687458297" kindref="member">twclogtail</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>pnumber,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>l,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bx,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>by,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dx,</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dpx,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dy,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dpy,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ax,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ay,</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>angle,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>k1l,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>k1sl,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ex,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ey,</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r0,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>aatom,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>gamma,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>en0,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>len,</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>amass,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>charge,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sige,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigt,</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*clog)<sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>constants</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ot2<sp/>=<sp/>1.0e2;</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ft8<sp/>=<sp/>5.0e8;</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ot5<sp/>=<sp/>1.0e5;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ttm3<sp/>=<sp/>2.0e-3;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>fac1<sp/>=<sp/>743.4;</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>fac2<sp/>=<sp/>1.44e-7;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>c<sp/>=<sp/><ref refid="NumericFunctions_8hpp_1aa31d45974a65b3b50eb72c5fa8663dc2" kindref="member">clight</ref>;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>const<sp/>double<sp/>hbar<sp/>=<sp/>1.0545718176461565e-34;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>electron_volt_joule_relationship<sp/>=<sp/>1.602176634e-19;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>tailcut<sp/>we<sp/>need<sp/>local<sp/>radiation<sp/>integrals</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*radint<sp/>=<sp/><ref refid="RadiationDamping_8hpp_1a273d98b9b67c5016b3a794a4b866f26d" kindref="member">RadiationDampingElement</ref>(l,<sp/>bx,<sp/>by,<sp/>dx,<sp/>dpx,<sp/>dy,<sp/>dpy,<sp/>ax,<sp/>ay,</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>angle,<sp/>k1l,<sp/>k1sl);</highlight></codeline>
<codeline lineno="220"><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>p0<sp/>=<sp/>en0<sp/>*<sp/>1.0e9;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>restE<sp/>=<sp/>amass<sp/>*<sp/>1.0e9;</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>particle_radius<sp/>=<sp/>charge<sp/>*<sp/>charge<sp/>/<sp/>aatom<sp/>*<sp/>1.54e-18;</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>CalphaEC<sp/>=<sp/>particle_radius<sp/>*<sp/>c<sp/>/<sp/>(3.0<sp/>*<sp/>restE<sp/>*<sp/>restE<sp/>*<sp/>restE)<sp/>*</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(p0<sp/>*<sp/>p0<sp/>*<sp/>p0<sp/>/<sp/>len);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>transverse<sp/>partition<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>jx<sp/>=<sp/>1.0<sp/>-<sp/>radint[3]<sp/>/<sp/>radint[0];</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>jy<sp/>=<sp/>1.0<sp/>-<sp/>radint[4]<sp/>/<sp/>radint[0];</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>alphax<sp/>=<sp/>2.0<sp/>*<sp/>CalphaEC<sp/>*<sp/>radint[0]<sp/>*<sp/>jx;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>alphay<sp/>=<sp/>2.0<sp/>*<sp/>CalphaEC<sp/>*<sp/>radint[0]<sp/>*<sp/>jy;</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>alphas<sp/>=<sp/>2.0<sp/>*<sp/>CalphaEC<sp/>*<sp/>radint[0]<sp/>*<sp/>(jx<sp/>+<sp/>jy);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tauradxbunch<sp/>=<sp/>(1.0<sp/>/<sp/>alphax)<sp/>/<sp/>gamma;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tauradybunch<sp/>=<sp/>(1.0<sp/>/<sp/>alphay)<sp/>/<sp/>gamma;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tauradsbunch<sp/>=<sp/>(1.0<sp/>/<sp/>alphas)<sp/>/<sp/>gamma;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tauradmax<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(<ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(tauradxbunch,<sp/>tauradybunch),<sp/>tauradsbunch);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>IMPORTANT:<sp/>HBAR<sp/>USED<sp/>HERE<sp/>IS<sp/>REDUCED<sp/>PLANCK<sp/>CONSTANT<sp/>IN<sp/>GEV!!!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>const<sp/>double<sp/>hbar<sp/>=<sp/>6.582119569e-25;<sp/>//<sp/>1.0545718176461565e-34;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>two<sp/>=<sp/>2.0;</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eight<sp/>=<sp/>8.0;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>betar<sp/>=<sp/>sqrt(1.0<sp/>-<sp/>1.0<sp/>/<sp/>(gamma<sp/>*<sp/>gamma));</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>qion<sp/>=<sp/>fabs(charge);</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>etrans<sp/>=<sp/>ft8<sp/>*<sp/>(gamma<sp/>*<sp/>en0<sp/>-<sp/>amass)<sp/>*<sp/>(ex<sp/>/<sp/>bx);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tempev<sp/>=<sp/>two<sp/>*<sp/>etrans;</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>beam<sp/>volume<sp/>to<sp/>get<sp/>density<sp/>(in<sp/>cm**-3).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigxcm<sp/>=<sp/>ot2<sp/>*<sp/>sqrt(ex<sp/>*<sp/>bx<sp/>+<sp/>(dx<sp/>*<sp/>dx<sp/>*<sp/>sige<sp/>*<sp/>sige));</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigycm<sp/>=<sp/>ot2<sp/>*<sp/>sqrt(ey<sp/>*<sp/>by<sp/>+<sp/>(dy<sp/>*<sp/>dy<sp/>*<sp/>sige<sp/>*<sp/>sige));</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigtcm<sp/>=<sp/>ot2<sp/>*<sp/>sigt;</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>vol<sp/>=<sp/>eight<sp/>*<sp/>sqrt(<ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref>)<sp/>*<sp/>sigxcm<sp/>*<sp/>sigycm<sp/>*<sp/>sigtcm;</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>densty<sp/>=<sp/>pnumber<sp/>/<sp/>vol;</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>RMAX<sp/>as<sp/>smaller<sp/>of<sp/>SIGXCM<sp/>and<sp/>DEBYE<sp/>length.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>debyel<sp/>=<sp/>fac1<sp/>*<sp/>sqrt(tempev<sp/>/<sp/>densty)<sp/>/<sp/>qion;</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmax<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1ac6afabdc09a49a433ee19d8a9486056d" kindref="member">min</ref>(sigxcm,<sp/>debyel);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>RMIN<sp/>as<sp/>larger<sp/>of<sp/>classical<sp/>distance<sp/>of<sp/>closest<sp/>approach</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>or<sp/>quantum<sp/>mechanical<sp/>diffraction<sp/>limit<sp/>from<sp/>nuclear<sp/>radius.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmincl<sp/>=<sp/>fac2<sp/>*<sp/>qion<sp/>*<sp/>qion<sp/>/<sp/>tempev;</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rminqm<sp/>=<sp/><ref refid="NumericFunctions_8hpp_1a0ae50bc0ad13e33e23eec85ec44b3e2b" kindref="member">hbar</ref><sp/>*<sp/>c<sp/>*<sp/>ot5<sp/>/<sp/>(two<sp/>*<sp/>sqrt(ttm3<sp/>*<sp/>etrans<sp/>*<sp/>amass));</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmin;</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tauradmax<sp/>&gt;<sp/>0.0)<sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmintailcut<sp/>=</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0f<sp/>/<sp/>sqrt(pnumber<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/>tauradmax<sp/>*<sp/>c<sp/>*<sp/>gamma<sp/>*<sp/>sqrt(ex<sp/>/<sp/>bx));</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>rmin<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(<ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(rmincl,<sp/>rminqm),<sp/>rmintailcut);</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/>rmin<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(rmincl,<sp/>rminqm);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>coulog<sp/>=<sp/>log(rmax<sp/>/<sp/>rmin);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>coulomb<sp/>log<sp/>constant<sp/>pre-factor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>constt<sp/>=<sp/>pnumber<sp/>*<sp/>coulog<sp/>*<sp/>r0<sp/>*<sp/>r0<sp/>*<sp/>c<sp/>/</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(eight<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/>betar<sp/>*<sp/>betar<sp/>*<sp/>betar<sp/>*<sp/>gamma<sp/>*<sp/>gamma<sp/>*<sp/>gamma<sp/>*</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gamma<sp/>*<sp/>ex<sp/>*<sp/>ey<sp/>*<sp/>sige<sp/>*<sp/>sigt);</highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/>clog[0]<sp/>=<sp/>coulog;</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/>clog[1]<sp/>=<sp/>constt;</highlight></codeline>
<codeline lineno="285"><highlight class="normal">}</highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="287"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="288"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="289"><highlight class="comment">METHOD<sp/>TO<sp/>CALCULATE<sp/>COULOMBLOG<sp/>PER<sp/>ELEMENT<sp/>OR<sp/>USING<sp/>RING<sp/>AVERAGED<sp/>VALUES</highlight></codeline>
<codeline lineno="290"><highlight class="comment"></highlight></codeline>
<codeline lineno="291"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="292"><highlight class="comment"><sp/><sp/>AUTHORS:</highlight></codeline>
<codeline lineno="293"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>MADX<sp/>COPYRIGHT<sp/>CERN</highlight></codeline>
<codeline lineno="294"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>TOM<sp/>MERTENS</highlight></codeline>
<codeline lineno="295"><highlight class="comment"></highlight></codeline>
<codeline lineno="296"><highlight class="comment"><sp/><sp/>HISTORY:</highlight></codeline>
<codeline lineno="297"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>08/06/2021<sp/>:<sp/>initial<sp/>cpp<sp/>version<sp/>(Tom)</highlight></codeline>
<codeline lineno="298"><highlight class="comment"></highlight></codeline>
<codeline lineno="299"><highlight class="comment"><sp/><sp/>REF:</highlight></codeline>
<codeline lineno="300"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculation<sp/>of<sp/>Coulomb<sp/>logarithm<sp/>(and<sp/>print)</highlight></codeline>
<codeline lineno="301"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>based<sp/>on<sp/>the<sp/>formulae<sp/>in<sp/>AIP<sp/>physics<sp/>vade<sp/>mecum<sp/>p.264<sp/>(1981)</highlight></codeline>
<codeline lineno="302"><highlight class="comment"></highlight></codeline>
<codeline lineno="303"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="304"><highlight class="comment"><sp/><sp/>Arguments:</highlight></codeline>
<codeline lineno="305"><highlight class="comment"><sp/><sp/>----------</highlight></codeline>
<codeline lineno="306"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>pnumber</highlight></codeline>
<codeline lineno="307"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>number<sp/>of<sp/>particles</highlight></codeline>
<codeline lineno="308"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>ex</highlight></codeline>
<codeline lineno="309"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>emittance<sp/>x</highlight></codeline>
<codeline lineno="310"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>ey</highlight></codeline>
<codeline lineno="311"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>emittance<sp/>y</highlight></codeline>
<codeline lineno="312"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>map&lt;string,<sp/>double&gt;&amp;<sp/>twissheader</highlight></codeline>
<codeline lineno="313"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>madx<sp/>twiss<sp/>header</highlight></codeline>
<codeline lineno="314"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>sige</highlight></codeline>
<codeline lineno="315"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>energy<sp/>spread</highlight></codeline>
<codeline lineno="316"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>sigt</highlight></codeline>
<codeline lineno="317"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bunch<sp/>length<sp/>(s)</highlight></codeline>
<codeline lineno="318"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>r0</highlight></codeline>
<codeline lineno="319"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>classical<sp/>particle<sp/>radius</highlight></codeline>
<codeline lineno="320"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>bool<sp/>printout</highlight></codeline>
<codeline lineno="321"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printout<sp/>summary</highlight></codeline>
<codeline lineno="322"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double*<sp/>clog</highlight></codeline>
<codeline lineno="323"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output<sp/>variable</highlight></codeline>
<codeline lineno="324"><highlight class="comment"></highlight></codeline>
<codeline lineno="325"><highlight class="comment"><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="326"><highlight class="comment"><sp/><sp/>--------</highlight></codeline>
<codeline lineno="327"><highlight class="comment"><sp/><sp/>double[2]<sp/>clog</highlight></codeline>
<codeline lineno="328"><highlight class="comment"><sp/><sp/><sp/><sp/>1<sp/>-&gt;<sp/>coulomblog</highlight></codeline>
<codeline lineno="329"><highlight class="comment"><sp/><sp/><sp/><sp/>2<sp/>-&gt;<sp/>coulomblog<sp/>constant</highlight></codeline>
<codeline lineno="330"><highlight class="comment"></highlight></codeline>
<codeline lineno="331"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="332"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="333"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="CoulombLogFunctions_8cpp_1ab908400a7d0b3f9d9d35da9684d875c2" kindref="member">CoulombLog</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>pnumber,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ex,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ey,</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>map&lt;string,<sp/>double&gt;<sp/>&amp;twissheader,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sige,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigt,</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r0,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>printout,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*clog)<sp/>{</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>const<sp/>double<sp/>one<sp/><sp/><sp/>=<sp/>1.0f;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>two<sp/>=<sp/>2.0;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>const<sp/>double<sp/>four<sp/><sp/>=<sp/>4.0f;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eight<sp/>=<sp/>8.0f;</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ot2<sp/>=<sp/>1.0e2;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ft8<sp/>=<sp/>5.0e8;</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ot5<sp/>=<sp/>1.0e5;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ttm3<sp/>=<sp/>2.0e-3;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>fac1<sp/>=<sp/>743.4;</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>fac2<sp/>=<sp/>1.44e-7;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>c<sp/>=<sp/><ref refid="NumericFunctions_8hpp_1aa31d45974a65b3b50eb72c5fa8663dc2" kindref="member">clight</ref>;</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>IMPORTANT:<sp/>HBAR<sp/>USED<sp/>HERE<sp/>IS<sp/>REDUCED<sp/>PLANCK<sp/>CONSTANT<sp/>IN<sp/>GEV!!!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>static<sp/>double<sp/>output[2];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>gamma<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;GAMMA&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>charge<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;CHARGE&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>len<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;LENGTH&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>en0<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;ENERGY&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>amass<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;MASS&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>q1<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;Q1&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>q2<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;Q2&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dxbar<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;DXRMS&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dybar<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;DYRMS&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="364"><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>necessary<sp/>parameters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>double<sp/>r0<sp/>=<sp/>charge<sp/>*<sp/>charge<sp/>/<sp/>aatom<sp/>*<sp/>1.54e-18;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>betar<sp/>=<sp/>sqrt(1<sp/>-<sp/>1<sp/>/<sp/>(gamma<sp/>*<sp/>gamma));</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bxbar<sp/>=<sp/>len<sp/>/<sp/>(2.0<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/>q1);<sp/></highlight><highlight class="comment">//<sp/>avg<sp/>betax</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bybar<sp/>=<sp/>len<sp/>/<sp/>(2.0<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/>q2);<sp/></highlight><highlight class="comment">//<sp/>avgbety</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>transverse<sp/>temperature<sp/>as<sp/>2*P*X&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>i.e.,<sp/>assume<sp/>the<sp/>transverse<sp/>energy<sp/>is<sp/>temperature/2.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>qion<sp/>=<sp/>fabs(charge);</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>etrans<sp/>=<sp/>ft8<sp/>*<sp/>(gamma<sp/>*<sp/>en0<sp/>-<sp/>amass)<sp/>*<sp/>(ex<sp/>/<sp/>bxbar);</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tempev<sp/>=<sp/>two<sp/>*<sp/>etrans;</highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>beam<sp/>volume<sp/>to<sp/>get<sp/>density<sp/>(in<sp/>cm**-3).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigxcm<sp/>=<sp/>ot2<sp/>*<sp/>sqrt(ex<sp/>*<sp/>bxbar<sp/>+<sp/>(dxbar<sp/>*<sp/>dxbar<sp/>*<sp/>sige<sp/>*<sp/>sige));</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigycm<sp/>=<sp/>ot2<sp/>*<sp/>sqrt(ey<sp/>*<sp/>bybar<sp/>+<sp/>(dybar<sp/>*<sp/>dybar<sp/>*<sp/>sige<sp/>*<sp/>sige));</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigtcm<sp/>=<sp/>ot2<sp/>*<sp/>sigt;</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>vol<sp/>=<sp/>eight<sp/>*<sp/>sqrt(<ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref>)<sp/>*<sp/>sigxcm<sp/>*<sp/>sigycm<sp/>*<sp/>sigtcm;</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>densty<sp/>=<sp/>pnumber<sp/>/<sp/>vol;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>RMAX<sp/>as<sp/>smaller<sp/>of<sp/>SIGXCM<sp/>and<sp/>DEBYE<sp/>length.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>debyel<sp/>=<sp/>fac1<sp/>*<sp/>sqrt(tempev<sp/>/<sp/>densty)<sp/>/<sp/>qion;</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmax<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1ac6afabdc09a49a433ee19d8a9486056d" kindref="member">min</ref>(sigxcm,<sp/>debyel);</highlight></codeline>
<codeline lineno="388"><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>RMIN<sp/>as<sp/>larger<sp/>of<sp/>classical<sp/>distance<sp/>of<sp/>closest<sp/>approach</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>or<sp/>quantum<sp/>mechanical<sp/>diffraction<sp/>limit<sp/>from<sp/>nuclear<sp/>radius.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmincl<sp/>=<sp/>fac2<sp/>*<sp/>qion<sp/>*<sp/>qion<sp/>/<sp/>tempev;</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rminqm<sp/>=<sp/><ref refid="NumericFunctions_8hpp_1a0ae50bc0ad13e33e23eec85ec44b3e2b" kindref="member">hbar</ref><sp/>*<sp/>c<sp/>*<sp/>ot5<sp/>/<sp/>(two<sp/>*<sp/>sqrt(ttm3<sp/>*<sp/>etrans<sp/>*<sp/>amass));</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmin<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(rmincl,<sp/>rminqm);</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>coulog<sp/>=<sp/>log(rmax<sp/>/<sp/>rmin);</highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>constt<sp/>=<sp/>pnumber<sp/>*<sp/>coulog<sp/>*<sp/>r0<sp/>*<sp/>r0<sp/>*<sp/>c<sp/>/</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(eight<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/>betar<sp/>*<sp/>betar<sp/>*<sp/>betar<sp/>*<sp/>gamma<sp/>*<sp/>gamma<sp/>*<sp/>gamma<sp/>*</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gamma<sp/>*<sp/>ex<sp/>*<sp/>ey<sp/>*<sp/>sige<sp/>*<sp/>sigt);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>cbunch<sp/>=<sp/>qion<sp/>*<sp/>pnumber<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a5cfb94a47bfcc4e20bfca979771abcfa" kindref="member">ec</ref><sp/>*<sp/>betar<sp/>*<sp/>c<sp/>/<sp/>len;</highlight></codeline>
<codeline lineno="400"><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(printout)<sp/>{</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Radius<sp/>max<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>rmax);</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Density<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>pow(densty,<sp/>-1.0<sp/>/<sp/>3.0));</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;CONST<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>constt);</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;ENERGY<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e<sp/>GeV\n&quot;</highlight><highlight class="normal">,<sp/>en0);</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;BETA<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>betar);</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;GAMMA<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>gamma);</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;COULOMB<sp/>LOG<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>coulog);</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;X-emittance<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e<sp/>m*rad\n&quot;</highlight><highlight class="normal">,<sp/>ex);</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Y-emittance<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e<sp/>m*rad\n&quot;</highlight><highlight class="normal">,<sp/>ey);</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Momentum<sp/>spread<sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>sige);</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Bunch<sp/>length<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e<sp/>m<sp/>\n&quot;</highlight><highlight class="normal">,<sp/>sigt);</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Particles<sp/>per<sp/>bunch<sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>pnumber);</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Bunch<sp/>current<sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e<sp/>A\n&quot;</highlight><highlight class="normal">,<sp/>cbunch);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="416"><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/>clog[0]<sp/>=<sp/>coulog;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/>clog[1]<sp/>=<sp/>constt;</highlight></codeline>
<codeline lineno="419"><highlight class="normal">}</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="421"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="422"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="423"><highlight class="comment">METHOD<sp/>TO<sp/>CALCULATE<sp/>COULOMBLOG<sp/>PER<sp/>ELEMENT<sp/>OR<sp/>USING<sp/>RING<sp/>AVERAGED<sp/>VALUES</highlight></codeline>
<codeline lineno="424"><highlight class="comment">WITH<sp/>TAILCUT.</highlight></codeline>
<codeline lineno="425"><highlight class="comment"></highlight></codeline>
<codeline lineno="426"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="427"><highlight class="comment"><sp/><sp/>AUTHORS:</highlight></codeline>
<codeline lineno="428"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>MADX<sp/>COPYRIGHT<sp/>CERN</highlight></codeline>
<codeline lineno="429"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>TOM<sp/>MERTENS</highlight></codeline>
<codeline lineno="430"><highlight class="comment"></highlight></codeline>
<codeline lineno="431"><highlight class="comment"><sp/><sp/>HISTORY:</highlight></codeline>
<codeline lineno="432"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>08/06/2021<sp/>:<sp/>initial<sp/>cpp<sp/>version<sp/>(Tom)</highlight></codeline>
<codeline lineno="433"><highlight class="comment"></highlight></codeline>
<codeline lineno="434"><highlight class="comment"><sp/><sp/>REF:</highlight></codeline>
<codeline lineno="435"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculation<sp/>of<sp/>Coulomb<sp/>logarithm<sp/>(and<sp/>print)</highlight></codeline>
<codeline lineno="436"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>based<sp/>on<sp/>the<sp/>formulae<sp/>in<sp/>AIP<sp/>physics<sp/>vade<sp/>mecum<sp/>p.264<sp/>(1981)</highlight></codeline>
<codeline lineno="437"><highlight class="comment"></highlight></codeline>
<codeline lineno="438"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="439"><highlight class="comment"><sp/><sp/>Arguments:</highlight></codeline>
<codeline lineno="440"><highlight class="comment"><sp/><sp/>----------</highlight></codeline>
<codeline lineno="441"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>pnumber</highlight></codeline>
<codeline lineno="442"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>number<sp/>of<sp/>particles</highlight></codeline>
<codeline lineno="443"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>ex</highlight></codeline>
<codeline lineno="444"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>emittance<sp/>x</highlight></codeline>
<codeline lineno="445"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>ey</highlight></codeline>
<codeline lineno="446"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>emittance<sp/>y</highlight></codeline>
<codeline lineno="447"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>map&lt;string,<sp/>double&gt;&amp;<sp/>twissheader</highlight></codeline>
<codeline lineno="448"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>madx<sp/>twiss<sp/>header</highlight></codeline>
<codeline lineno="449"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>sige</highlight></codeline>
<codeline lineno="450"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>energy<sp/>spread</highlight></codeline>
<codeline lineno="451"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>sigt</highlight></codeline>
<codeline lineno="452"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bunch<sp/>length<sp/>(s)</highlight></codeline>
<codeline lineno="453"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>tauradx</highlight></codeline>
<codeline lineno="454"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>radiation<sp/>lifetime<sp/>x</highlight></codeline>
<codeline lineno="455"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>taurady</highlight></codeline>
<codeline lineno="456"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>radiation<sp/>lifetime<sp/>y</highlight></codeline>
<codeline lineno="457"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>taurads</highlight></codeline>
<codeline lineno="458"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>radiation<sp/>lifetime<sp/>s</highlight></codeline>
<codeline lineno="459"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double<sp/>r0</highlight></codeline>
<codeline lineno="460"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>classical<sp/>particle<sp/>radius</highlight></codeline>
<codeline lineno="461"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>bool<sp/>printout</highlight></codeline>
<codeline lineno="462"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printout<sp/>summary</highlight></codeline>
<codeline lineno="463"><highlight class="comment"><sp/><sp/><sp/><sp/>-<sp/>double*<sp/>clog</highlight></codeline>
<codeline lineno="464"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output<sp/>variable</highlight></codeline>
<codeline lineno="465"><highlight class="comment"></highlight></codeline>
<codeline lineno="466"><highlight class="comment"><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="467"><highlight class="comment"><sp/><sp/>--------</highlight></codeline>
<codeline lineno="468"><highlight class="comment"><sp/><sp/>double[2]<sp/>clog</highlight></codeline>
<codeline lineno="469"><highlight class="comment"><sp/><sp/><sp/><sp/>1<sp/>-&gt;<sp/>coulomblog</highlight></codeline>
<codeline lineno="470"><highlight class="comment"><sp/><sp/><sp/><sp/>2<sp/>-&gt;<sp/>coulomblog<sp/>constant</highlight></codeline>
<codeline lineno="471"><highlight class="comment"></highlight></codeline>
<codeline lineno="472"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="473"><highlight class="comment">================================================================================</highlight></codeline>
<codeline lineno="474"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="CoulombLogFunctions_8cpp_1ada19d63bb5e67dfd7885b4bd24c5bcb1" kindref="member">TailCutCoulombLog</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>pnumber,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ex,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ey,</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>map&lt;string,<sp/>double&gt;<sp/>&amp;twissheader,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sige,</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigt,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tauradx,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>taurady,</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>taurads,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r0,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>printout,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*clog)<sp/>{</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>const<sp/>double<sp/>one<sp/><sp/><sp/>=<sp/>1.0f;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>two<sp/>=<sp/>2.0f;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>const<sp/>double<sp/>four<sp/><sp/>=<sp/>4.0f;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eight<sp/>=<sp/>8.0f;</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ot2<sp/>=<sp/>1.0e2;</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ft8<sp/>=<sp/>5.0e8;</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ot5<sp/>=<sp/>1.0e5;</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ttm3<sp/>=<sp/>2.0e-3;</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>fac1<sp/>=<sp/>743.4;</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>fac2<sp/>=<sp/>1.44e-7;</highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>c<sp/>=<sp/><ref refid="NumericFunctions_8hpp_1aa31d45974a65b3b50eb72c5fa8663dc2" kindref="member">clight</ref>;</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>const<sp/>double<sp/>pi<sp/>=<sp/>3.141592653589793f;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>const<sp/>double<sp/>ec<sp/>=<sp/>1.602176634e-19;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>IMPORTANT:<sp/>HBAR<sp/>USED<sp/>HERE<sp/>IS<sp/>REDUCED<sp/>PLANCK<sp/>CONSTANT<sp/>IN<sp/>GEV!!!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//-----------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>const<sp/>double<sp/>hbar<sp/>=<sp/>6.582119569e-25;<sp/>//<sp/>1.0545718176461565e-34;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>static<sp/>double<sp/>output[2];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>gamma<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;GAMMA&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>charge<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;CHARGE&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>len<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;LENGTH&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>en0<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;ENERGY&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>amass<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;MASS&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>q1<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;Q1&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>q2<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;Q2&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dxbar<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;DXRMS&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dybar<sp/>=<sp/>twissheader[</highlight><highlight class="stringliteral">&quot;DYRMS&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>double<sp/>gammatr<sp/>=<sp/>twissheader[9];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="512"><highlight class="normal"></highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>necessary<sp/>parameters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>double<sp/>r0<sp/>=<sp/>charge<sp/>*<sp/>charge<sp/>/<sp/>aatom<sp/>*<sp/>1.54e-18;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>betar<sp/>=<sp/>sqrt(1<sp/>-<sp/>1<sp/>/<sp/>(gamma<sp/>*<sp/>gamma));</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bxbar<sp/>=<sp/>len<sp/>/<sp/>(2.0<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/>q1);<sp/></highlight><highlight class="comment">//<sp/>avg<sp/>betax</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bybar<sp/>=<sp/>len<sp/>/<sp/>(2.0<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/>q2);<sp/></highlight><highlight class="comment">//<sp/>avgbety</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tauradxbunch<sp/>=<sp/>tauradx<sp/>/<sp/>gamma;</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tauradybunch<sp/>=<sp/>taurady<sp/>/<sp/>gamma;</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tauradsbunch<sp/>=<sp/>taurads<sp/>/<sp/>gamma;</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tauradmax<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(<ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(tauradxbunch,<sp/>tauradybunch),<sp/>tauradsbunch);</highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>transverse<sp/>temperature<sp/>as<sp/>2*P*X&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>i.e.,<sp/>assume<sp/>the<sp/>transverse<sp/>energy<sp/>is<sp/>temperature/2.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>qion<sp/>=<sp/>fabs(charge);</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>etrans<sp/>=<sp/>ft8<sp/>*<sp/>(gamma<sp/>*<sp/>en0<sp/>-<sp/>amass)<sp/>*<sp/>(ex<sp/>/<sp/>bxbar);</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tempev<sp/>=<sp/>two<sp/>*<sp/>etrans;</highlight></codeline>
<codeline lineno="529"><highlight class="normal"></highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>beam<sp/>volume<sp/>to<sp/>get<sp/>density<sp/>(in<sp/>cm**-3).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigxcm<sp/>=<sp/>ot2<sp/>*<sp/>sqrt(ex<sp/>*<sp/>bxbar<sp/>+<sp/>(dxbar<sp/>*<sp/>dxbar<sp/>*<sp/>sige<sp/>*<sp/>sige));</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigycm<sp/>=<sp/>ot2<sp/>*<sp/>sqrt(ey<sp/>*<sp/>bybar<sp/>+<sp/>(dybar<sp/>*<sp/>dybar<sp/>*<sp/>sige<sp/>*<sp/>sige));</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigtcm<sp/>=<sp/>ot2<sp/>*<sp/>sigt;</highlight></codeline>
<codeline lineno="534"><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>vol<sp/>=<sp/>eight<sp/>*<sp/>sqrt(<ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref>)<sp/>*<sp/>sigxcm<sp/>*<sp/>sigycm<sp/>*<sp/>sigtcm;</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>densty<sp/>=<sp/>pnumber<sp/>/<sp/>vol;</highlight></codeline>
<codeline lineno="537"><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>RMAX<sp/>as<sp/>smaller<sp/>of<sp/>SIGXCM<sp/>and<sp/>DEBYE<sp/>length.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>debyel<sp/>=<sp/>fac1<sp/>*<sp/>sqrt(tempev<sp/>/<sp/>densty)<sp/>/<sp/>qion;</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmax<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1ac6afabdc09a49a433ee19d8a9486056d" kindref="member">min</ref>(sigxcm,<sp/>debyel);</highlight></codeline>
<codeline lineno="541"><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//----<sp/>Calculate<sp/>RMIN<sp/>as<sp/>larger<sp/>of<sp/>classical<sp/>distance<sp/>of<sp/>closest<sp/>approach</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>or<sp/>quantum<sp/>mechanical<sp/>diffraction<sp/>limit<sp/>from<sp/>nuclear<sp/>radius.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmincl<sp/>=<sp/>fac2<sp/>*<sp/>qion<sp/>*<sp/>qion<sp/>/<sp/>tempev;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rminqm<sp/>=<sp/><ref refid="NumericFunctions_8hpp_1a0ae50bc0ad13e33e23eec85ec44b3e2b" kindref="member">hbar</ref><sp/>*<sp/>c<sp/>*<sp/>ot5<sp/>/<sp/>(two<sp/>*<sp/>sqrt(ttm3<sp/>*<sp/>etrans<sp/>*<sp/>amass));</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmintailcut<sp/>=</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>1.0<sp/>/<sp/>sqrt(pnumber<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/>tauradmax<sp/>*<sp/>c<sp/>*<sp/>gamma<sp/>*<sp/>sqrt(ex<sp/>/<sp/>bxbar));</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rmin<sp/>=<sp/><ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(<ref refid="NumericFunctions_8cpp_1affe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(rmincl,<sp/>rminqm),<sp/>rmintailcut);</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>coulog<sp/>=<sp/>log(rmax<sp/>/<sp/>rmin);</highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>constt<sp/>=<sp/>pnumber<sp/>*<sp/>coulog<sp/>*<sp/>r0<sp/>*<sp/>r0<sp/>*<sp/>c<sp/>/</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(eight<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a43016d873124d39034edb8cd164794db" kindref="member">pi</ref><sp/>*<sp/>betar<sp/>*<sp/>betar<sp/>*<sp/>betar<sp/>*<sp/>gamma<sp/>*<sp/>gamma<sp/>*<sp/>gamma<sp/>*</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gamma<sp/>*<sp/>ex<sp/>*<sp/>ey<sp/>*<sp/>sige<sp/>*<sp/>sigt);</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>cbunch<sp/>=<sp/>qion<sp/>*<sp/>pnumber<sp/>*<sp/><ref refid="NumericFunctions_8hpp_1a5cfb94a47bfcc4e20bfca979771abcfa" kindref="member">ec</ref><sp/>*<sp/>betar<sp/>*<sp/>c<sp/>/<sp/>len;</highlight></codeline>
<codeline lineno="555"><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(printout)<sp/>{</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Radius<sp/>max<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>rmax);</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Density<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>pow(densty,<sp/>-1.0f<sp/>/<sp/>3.0f));</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;CONST<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>constt);</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;ENERGY<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e<sp/>GeV\n&quot;</highlight><highlight class="normal">,<sp/>en0);</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;BETA<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>betar);</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;GAMMA<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>gamma);</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;COULOMB<sp/>LOG<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>coulog);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;X-emittance<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e<sp/>m*rad\n&quot;</highlight><highlight class="normal">,<sp/>ex);</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Y-emittance<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e<sp/>m*rad\n&quot;</highlight><highlight class="normal">,<sp/>ey);</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Momentum<sp/>spread<sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>sige);</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Bunch<sp/>length<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e<sp/>m<sp/>\n&quot;</highlight><highlight class="normal">,<sp/>sigt);</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Particles<sp/>per<sp/>bunch<sp/>;<sp/>%.8e\n&quot;</highlight><highlight class="normal">,<sp/>pnumber);</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Bunch<sp/>current<sp/><sp/><sp/><sp/><sp/><sp/><sp/>;<sp/>%.8e<sp/>A\n&quot;</highlight><highlight class="normal">,<sp/>cbunch);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="571"><highlight class="normal"></highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/>clog[0]<sp/>=<sp/>coulog;</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/>clog[1]<sp/>=<sp/>constt;</highlight></codeline>
<codeline lineno="574"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/home/mti/github-tomerten/ibs/cpp/src/CoulombLogFunctions.cpp"/>
  </compounddef>
</doxygen>
